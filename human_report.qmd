---
title: "Lien entre la santé et données anthropométriques d'un échantillon"
author: "MartinJadouille, LouiseDubrecq, PierreMartin, SarahDelapierre"
date: "`r Sys.Date()`"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: bibliography/references.bib
---

<!--% Complétez l'entête en définissant un titre qui soit représentatif de votre travail. Indiquez aussi les noms des auteurs. -->

<!--# Dans les différentes sections, vous trouverez des indicateurs "...Vos XXX ici..." Vous devez bien sûr REMPLACER ces indicateurs par votre propre texte. Ne les laissez pas dans votre version finale du document. Vous devez travailler dans le même document (pas question de faire un document séparé par étudiant). Gérez les conflits éventuels. -->

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configuration de l'environnement SciViews::R
SciViews::R("infer", "model", lang = "fr")
```

# Introduction

<!--% Sur base de la bibliographie (lecture de l'article fourni et de vos propres recherches sur Internet), rédigez une introduction du sujet en 3 à 4 paragraphes. Cette introduction doit guider le lecteur vers votre but. Vous devez citer vos sources, c'est-à-dire qu’il faut indiquer au minimum la référence bibliographique fournie de manière correcte (inspirez-vous de ce qui est indiqué dans le bloc-notes, mais reformulez : un simple copier-coller de l'introduction du bloc-notes n'est PAS considéré comme l'exercice réalisé !) -->

<!--# Ce projet porte sur la santé humaine liée à l'obésité, à la façon de se nourrir et aux activités réalisées (plus ou moins sédentaire ou actif) ... Réalisez des recherches bibliographiques afin d'avoir une vision précise de la thématique. Existe-t-il des indicateurs calculables pour quantifier l'état de santé d'un individu, par exemple ? Naturellement, ces indicateurs doivent être calculables sur bases des variables mesurées dans votre jeu de données. Focalisez-vous donc sur ces variables-là. -->

En Belgique, la santé de la population est un sujet de préoccupation, en particulier en ce qui concerne les indicateurs anthropométriques tels que l'indice de masse corporelle (IMC), le tour de taille, l'activité physique et certains ratios/indices calculables. Ces données ne correspondent pas toujours aux valeurs définies par l'Organisation mondiale de la santé (OMS). En effet, la Belgique connaît une augmentation des problèmes de surpoids et d'obésité, des facteurs ayant des impacts considérables sur la santé publique.

En Belgique, la santé de la population est un sujet de préoccupation, en particulier en ce qui concerne les indicateurs anthropométriques tels que l'indice de masse corporelle (IMC), le tour de taille, l'activité physique et certains ratios/indices calculable. Ces données ne correspondent pas toujours aux valeurs définis par l'Organisation mondiale de la santé (OMS). En effet, la Belgique connaît une augmentation des problèmes de surpoids et d'obésité, des facteurs ayant des impacts considérables sur la santé publique ( problèmes cardiaque, cancers, troubles,\...).

Notre travail vise à visualiser les résultats obtenus par @lebacq2015 avec un échantillon de la population belge. À l'aide de tests statistiques et de graphiques, nous analyserons les différences et similitudes dans les tendances observées. Cette étude permettra d'évaluer l'état de santé de la population et d'identifier les mesures de prévention nécessaires pour améliorer le bien-être des citoyens belges.

<!--% Formulez ici de façon concise et précise votre question de recherche en 1 à 2 phrases. -->

Que révèlent les données anthropométriques de notre échantillon et celles de @lebacq2015 sur l'état de santé de la population belge ?

# Matériel et méthodes

<!--% Cette section doit comprendre une explication technique sur les mesures effectuées et sur le protocole relatif à l'acquisition des données en 3 à 4 paragraphes. Vous ajouterez aussi un paragraphe qui détaille les outils logiciels et statistiques utilisés (logiciels et versions des logiciels). Un simple copier-coller du matériel et méthodes du bloc-notes ne sera PAS considéré comme acceptable. -->

Dans le cadre de ce travail, les données ont été collectées fin 2024 par une classe de 36 élèves. Chaque élève a dû mesurer 4 personnes (aléatoire, famille, amis,\...) pour un total de 144 personnes. Les variables à mesurer ont été définies collectivement avant le début des relevés pour une parfaite compréhension entre tous les élèves. Ces variables ont été listées dans un dictionnaire de données. Celui-ci permet une uniformisation des relevés pour les unités, le nom des variables,\...

De plus, pour limiter les erreurs de mesure sur la masse nous avons réalisé une inter-calibration ce qui permet une meilleure exactitude des résultats.

Nous avons également dû respecter strictement la règle de l'anonymat des personnes mesurées, conformément au RGPD. Tous les volontaires ont donc été identifiés uniquement par un code anonyme.

Les données et les tests statistiques sont réalisés avec le logiciel R en version 4.3.0 (2023-04-21) -- "Already Tomorrow" et un système d'exploitation Linux 64 bits, avec une architecture x86_64.

# Résultats

## Description des données

<!--% Extrayez les quelques éléments les plus pertinents (3 à 5) de votre document `human_notebook.qmd` pour décrire les données de manière cohérente par rapport au but. Reprenez les interprétations en les reformulant de manière concise pour former un texte qui se lit en continu (donc un texte plus construit que ce que vous avez indiqué dans le bloc-notes). -->

<!--# N'oubliez pas que ce document doit pouvoir compiler indépendamment du reste. Cela implique que vous ajoutiez un chunk d'importation des données et que vous recalculiez tout ce qui doit l'être... Par contre, un simple copier-coller de toute la partie résultats du bloc-notes ne sera pas considéré comme un travail réalisé : vous devez sélectionner, et éventuellement remanier un peu le code, pour ne conserver que ce qui est utile ici. -->

```{r importation}
biometry <- read("data/biometry.rds")
```

### Description

```{r description age et sexe}

# Découpage en classe : différentes tranches d'age (18-35, 35-50, 50>=)
biometry$age_rec <- cut(biometry$age,
  include.lowest = TRUE,
  right = FALSE,
  dig.lab = 4,
  breaks = c(18, 35, 50, 80.2026),
  labels = c("Jeunes adultes", "Adultes matures", "Seniors"))

# Tableau de contingence
tab_sex_age <- table(biometry$age_rec, biometry$genre)

# Noms des variables et de leurs niveaux.
#NB : names(dimnames() renome le nom de la variable tandis que dimnames() renomme ses niveaux.

dimnames(tab_sex_age) <- list(c("Jeunes adultes", "Adultes matures", "Seniors"), c("Homme", "Femme"))
names(dimnames(tab_sex_age)) <- c("Tranche_d_âge", "Genre")


# Affichage du tableau
tabularise(tab_sex_age)
```

```{r description 2}
A<-chart(biometry, masse_corr ~ taille %col=% genre) +
  geom_point() +
  xlab("Taille(cm)") +
  ylab("Masse(kg)")+
  labs(title = "Relation taille/masse", col = "Genre")

B<-chart(biometry, masse_corr ~ tour_hanche %col=% genre) +
geom_point() +
  ylab("Masse des individus (kg)")+
  xlab("Taille du tour de hanche (cm)")+
  labs(title = "Relation taille/tour de hanche", col = "Genre")

combine_charts(list(A, B))
```

```{r description 3}
biometry %>.%
  sgroup_by(., genre) %>.%
  ssummarise(.,
    "Moyenne du tour de poignet(cm)" = fmean(tour_poignet),
    "Moyenne de la taille(cm)" = fmean(taille),
    "Moyenne du tour de hanche(cm)" = fmean(tour_hanche),
    "Moyenne de la masse(kg)" = fmean(masse_corr),
    "Moyenne du tour de taille(cm)" = fmean(tour_taille),
    "n" = fn(genre))->Moyenne_tab_mesure
colnames(Moyenne_tab_mesure)[1] <- "Genre"
tabularise(Moyenne_tab_mesure)

biometry <- biometry %>.%
  smutate(.,IMC = masse_corr / (taille / 100)^2)

biometry %>.%
  sgroup_by(., genre) %>.%
  ssummarise(.,
    "Moyenne de cigarettes" = fmean(fumeur),
    "Moyenne alcool (verres/sem)" = fmean(alcool),
    "Moyenne des fast-food" = fmean(fast_food),
    "Moyenne d'activités physiques (min)" = fmean(activite_physique),
    "Moyenne de l'IMC" = fmean(IMC),
    "n" = fn(masse_corr)) ->
  Moyenne_tab_act

colnames(Moyenne_tab_act) <- c("Genre", "Moyenne de cigarettes", "Moyenne alcool (verres/sem)", 
                       "Moyenne des fast-food", "Moyenne activité physique (min)", "Moyenne de l'IMC", "n")

tabularise(Moyenne_tab_act, auto.labs = FALSE)



```

```{r description 4}
chart(data = biometry, taille/100 ~ genre  %fill=%  genre |alimentation ) +
  xlab("Genre") +
  ylab("Taille (m)") +
  labs(title = "Taille des individus selon leur genre et leur alimentation") +
  geom_boxplot()

biometry %>.%
sselect(biometry,genre, alimentation) %>.%
table(biometry$genre, biometry$alimentation) -> regime_tab
dimnames(regime_tab) <- list(Genre = c("Femme", "Homme"),
Alimentation = c("Omnivore", "Carnivore", "Végétarien"))
names(dimnames(regime_tab)) <- c( "Genre", "Régime_alimentaire")
  tabularise(regime_tab)
```

$Interprétation$

L'échantillon analysé est composé majoritairement de jeunes adultes (64,1 %), avec une répartition équilibrée entre hommes et femmes dans cette tranche d'âge. Les adultes matures représentent 16,2 % de la population, dont 60 % sont des femmes, tandis que les seniors constituent 19,7 %, avec une proportion féminine de 60,7 %. Ces déséquilibres de genre dans les tranches d'âge les plus élevées devront être pris en compte dans l'interprétation des résultats, notamment lorsqu'il s'agit d'analyser les effets de l'âge ou du sexe.

Le premier graphique met en évidence une relation positive entre la taille et la masse corporelle, quel que soit le genre. Il illustre également que les hommes sont en moyenne plus grands et plus lourds que les femmes. On y remarque une variation dans la forme de la courbe selon le sexe, ce qui suggère des morphologies différentes entre hommes et femmes -- une hypothèse explorée plus précisément dans la suite de l'analyse.

Les tableaux de synthèse viennent appuyer ces observations en détaillant les différences morphologiques et comportementales entre les genres. Les hommes présentent une taille, une masse, un tour de poignet et un tour de taille moyens supérieurs à ceux des femmes, tandis que les femmes ont un tour de hanche plus élevé. Ces différences confortent l'idée de profils corporels distincts.

Sur le plan des comportements liés à la santé, les femmes déclarent fumer davantage, mais les hommes consomment plus d'alcool, fréquentent plus les fast-foods et pratiquent davantage d'activité physique. Malgré ces divergences, l'IMC moyen est similaire dans les deux groupes, légèrement au-dessus de 25, suggérant un niveau comparable de surcharge pondérale.

Le dernier graphique explore le lien entre régime alimentaire, genre et taille. On y confirme que les hommes sont plus grands que les femmes, tous régimes confondus. Chez les hommes, la taille médiane varie peu entre omnivores et carnivores. Chez les femmes, les végétariennes semblent légèrement plus grandes que les carnivores, avec une taille comparable aux omnivores. Toutefois, les effectifs très faibles dans les groupes carnivore et végétarien, ainsi que des données manquantes chez les hommes, limitent fortement l'interprétation de ces résultats.(voir tableau sur les effectifs en fonction du régime alimentaire) On ne peut, à ce stade, tirer aucune conclusion solide sur l'effet du régime alimentaire sur la taille.

## Indices de santé

### Indice 1

```{r indice4__Sarah_Delapierre}
#Calcul de la ou des variables reprenant l'indice sous forme numérique (et facteur)

biometry1 <- biometry %>%
  drop_na()

biometry1 %>.%
  sselect(., masse, taille, genre, age_rec, age) %>.%
  smutate(.,
    IMC = masse / (taille / 100)^2,
    IMC_cat = case_when(
      IMC < 18.5 ~ "Carence pondérale",
      IMC >= 18.5 & IMC < 25 ~ "Corpulence normale",
      IMC >= 25 & IMC < 30 ~ "Surcharge pondérale",
      IMC >= 30 ~ "Obésité")
  ) -> biometry_imc

biometry_imc$IMC_cat <- as.factor(biometry_imc$IMC_cat)
```

La formule pour calculer cet indice est:

$IMC = \frac{\text{Poids} \ (\text{g})}{\text{Taille}^2 \ (\text{m}^2)}$

### Indice 2

```{r indice1_Louise_Dubrecq}
 biometry1 <- smutate(biometry,
  ratio_taille_hanche = tour_taille / tour_hanche)
  
  biometry1 <- smutate(biometry1,
   RTH = ifelse(genre == "F",
      case_when(
         ratio_taille_hanche < 0.65 ~ "gynoïde",
         ratio_taille_hanche >= 0.65 & ratio_taille_hanche < 0.8 ~ "Normal",
         ratio_taille_hanche >= 0.8 ~ "androïde"), 
      case_when(
    ratio_taille_hanche < 0.85 ~ "gynoïde",
    ratio_taille_hanche >= 0.85 & ratio_taille_hanche < 0.95 ~ "Normal",
    ratio_taille_hanche >= 0.95 ~ "androïde")))
```

La formule pour calculer cet indice est :

$$
RTH = \frac{\text{Tour de taille (cm)}}{\text{Tour de hanche (cm)}}
$$

### Indice 3

```{r indice1__Pierre_Martin}

# Calcul de la ou des variables reprenant l'indice sous forme numérique (et facteur)

#IMG=(1.51×IMC)+(0.70× age)−(3.6×sexe)−1.4

biometry <- biometry %>.%
  smutate(., 
    genre_img = ifelse(genre == "H", 1, 0),
    Indice_de_masse_grasse = ((1.2 * IMC) + (0.23 * age) - (10.8 * genre_img) - 5.4))

tabularise$headtail(biometry) 

```

La formule pour calculer cet indice est:

Pour les femmes

$$ {IMG} = (1.2 \times \text{IMC}) + (0.23 \times \text{Âge}) - 5.4 $$

Pour les hommes

$$ {IMG} = (1.2 \times \text{IMC}) + (0.23 \times \text{Âge}) - 16.2) $$

Formule utilisée fusionnant les 2 formules

$$ {IMG} = (1.2 \times \text{IMC}) + (0.23 \times \text{Âge}) - (10.8 \times \text{Genre}) - 5.4 $$

Avec comme valeur 1 si genre = homme et 0 si genre = femme

$Interprétation$

L'IMC, indice de masse corporelle, nous permet de déterminer le type de corpulence d'un individu : de savoir si il se trouve en sous-poids, à corpulence normale, en surpoids ou en obésité. La mesure de l'IMC ne tient pas en compte du genre de l'individu. Cette variable nous permettra ensuite de pouvoir calculer l'IMG, l'indice de masse grasse, qui lui prendra en compte le genre de l'individu. Cet indice nous donnera la masse grasse d'un individu et par extension sa masse maigre. Le ratio de tour taille/tour de hanche, quant à lui permettra d'appuyer les données en fournissant plus d'informations sur la répartition de la masse grasse, ce qui permettra ainsi de déduire si le type d'obésité est soit normal, soit androïde soit gynoide.

## Tests d'hypothèses

<!--% Sélectionnez les 4 tests d'hypothèses les plus pertinents depuis `human_notebook.qmd`, ainsi bien sûr que les calculs des indices nécessaires que vous placerez juste au-dessus de vos tests. Ces tests doivent répondre à votre question de recherche (le but). Reformulez les interprétations pour former un texte qui se lit en continu. -->

Comparaison de la masse par tranche d'âge :

```{r Anova à 1 facteur}
#NB : obtenir des valeurs suppl sans savoir à quoi cela se rapporte = présence de valeurs manquantes. (→sdrop.na() ou )
biometry1 %>.%
sgroup_by(., age_rec) %>.%
ssummarise(.,
"Moyenne IMC" = fmean(IMC)) ->     imc_tab
names(imc_tab)[1] <- "Classe d'âge"
tabularise(imc_tab, auto.labs = FALSE)


chart(data = biometry_imc[!is.na(biometry_imc$age_rec), ], IMC ~ age_rec) +
  geom_boxplot() +
  geom_jitter(width = 0.05, alpha = 0.5) +
  stat_summary( geom = "point", fun = "mean" , color = "red") +  
  labs(title = "IMC par tranche d'âge", y = "IMC", x = "Tranche d'âge") 

anova(anova_IMC <- lm(data = biometry1, IMC ~ age_rec))|> tabularise()

summary(IMC_posthoc <- confint(multcomp::glht(anova_IMC,
  linfct = multcomp::mcp(age_rec = "Tukey"))))
oma <- par(oma = c(0, 5.1, 0, 0))
plot(IMC_posthoc)
par(oma)
rm(oma)
```

Comparaison de l'indice de masse grasse par genre :

```{r Anova à un facteur}
IMG_anova <- lm (data = biometry, Indice_de_masse_grasse ~ genre )
anova(IMG_anova)|> tabularise()

chart(data = biometry, Indice_de_masse_grasse  ~ genre ) +
  geom_boxplot() +
  geom_jitter(width = 0.05, alpha = 0.5) +
  stat_summary(geom = "point", fun = "mean", color = "red", size = 3) +
  ylab("Indice de masse grasse")

summary(IMG_posthoc <- confint(multcomp::glht(IMG_anova, linfct = multcomp::mcp(genre = "Tukey"))))
plot(IMG_posthoc)
```

Comparaison de l'influence du type d'obésité sur la masse en fonction du genre :

```{r Anova à 2 facteurs}
a <- chart(biometry1[genre == "F"], masse_corr[genre == "F"] ~ RTH[genre == "F"] %col=% RTH[genre == "F"]) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "Masse des femmes",
       x = "Type d'obésité",
       y = "Masse (kg)")

b <- chart(biometry1[genre == "H"], masse_corr[genre == "H"] ~ RTH[genre == "H"] %col=% RTH[genre == "H"]) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "Masse des hommes",
       x = "Type d'obésité",
       y = "Masse (kg)")

combine_charts(list(a, b))

#Anova
biometry1$RTH <- as.factor(biometry1$RTH)
biometry1$sucre<- as.factor(biometry1$genre)
biometry1$RTH_genre <- interaction(biometry1$RTH, biometry1$genre)

anova(RTH_anova2 <- lm(data = biometry1, masse_corr ~ RTH_genre)) %>.%
tabularise(.)

#Test Posthoc
summary(RTH_testposthoc <- confint(multcomp::glht(RTH_anova2,
  linfct = multcomp::mcp(RTH_genre = "Tukey"))))
oma <- par(oma = c(0, 5.1, 0, 0))
plot(RTH_testposthoc)
```

Influence de l'IMC par le genre :

```{r Test CHI2}
imc_tabcontingence <- table(biometry_imc$genre, biometry_imc$IMC)
chisq.test(imc_tabcontingence)

tabularise(imc_tabcontingence)
```

Les tests d'hypothèses précédents ont pour but de vérifier si des données démographiques influencent la masse. Premièrement, afin d'observer l'influence des différentes tranches d'âge sur la masse, une anova à un facteur à été réalisée. Elle permet de conclure qu'il y a une différence significative de masse uniquement entre deux groupes d'âges; les seniors et les jeunes adultes (ANOVA, F = 6.71, ddl = 2& 137, valeur p = 0.00166).

Egalement, nous avons comparé les genres. Il y a une différence d'indice de masse grasse significative entre les hommes et les femmes (Anova, ddl : 1, Fobs : 60.2, p : 1.57 \* 10\^(-12)). Ces-dernières ont tendances à avoir une médiane d'indice de masse graisseuse plus haute.

Suite à cela et pour confirmer le graphique en boîte à moustache "rapport taille-hanche en fonction du sexe", nous avons réalisé une Anova à 2 facteurs, examinant l'influence qu'a le type d'obésité sur la masse en fonction du genre. Le test a validé les boites à moustaches avec pour résultat une variation significative entre les genres concernant l'influence du type d'obésité sur la masse (ANOVA, ddl : 4, Fobs : 13.1, 4.46\*10\^(-09)). Le test post-hoc nous permet d'être plus précis : il y a une différence entre les femmes et les hommes normaux, entre les femmes normales et les hommes à obésité androïde et entre les femmes et les hommes à obésité androïde. On observe aussi que les femmes n'ont pas d'obésité gynoïde.

Pour finir, nous avons voulu voir si le genre influençait l'IMC. Le test n'a pas rejeté l'hypothèse de départ et donc nous ne pouvons pas prouver de manière significative qu'il y a une relation entre l'IMC et le genre au seuil alpha de 5% (X-squared = 2.9238, df = 3, p-value = 0.4035).

# Discussion et conclusions

<!--% Reprenez les résultats obtenus, discutez-les d'un point de vue biologique en 4 à 5 paragraphes et concluez votre travail. Vous pouvez les mettre également en relation avec vos recherches bibliographiques dans cette section. -->

...Vos conclusions ici...

Du point de vue des différences hommes-femmes, on peut remarquer directement des différences de masse, de taille et de pratique d'activités physiques. Pour analyser plus en profondeur ce sujet, nous avons comparé le rapport taille hanche des différents genres en les liant à des types d'obésités. Nous avons également réalisé une Anova pour observer l'influence du rapport taille hanche sur la masse en fonction du sexe. Les résultats nous montrent une différence significative entre les hommes et les femmes concernant l'influence du rapport taille hanche sur la masse. Egalement, le graphique de l'indice 2 nous montre visuellement ce phénomène. On observe que l'obésité androïde est plus fréquente chez les hommes que chez les femmes. Aucune femme de notre échantillon n'est en obésité gynoïde, certainement du à leurs morphologie la plus commune en forme de type "poire" qui accepte une plus large gamme de rapport taille hanche sans que cela soit du à une obésité.

<!--# Important : ce document doit compiler SANS ERREURS avec le bouton 'Rendu' sinon le travail sera sanctionné lourdement. La compilation du document Quarto est maintenant considérée comme acquise. -->

# Référence

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
